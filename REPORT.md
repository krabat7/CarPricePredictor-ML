# Отчет по проекту предсказания стоимости автомобиля

## Описание задачи
Цель работы — построить модель, которая максимально точно предсказывает стоимость автомобилей на основе доступных данных. Работа включала в себя несколько этапов, включая анализ данных, обработку признаков, подбор моделей и их оптимизацию. Итогом стало создание сервиса с FastAPI, который предоставляет предсказания стоимости на основе модели.

## Этапы работы

### 1. Подготовка данных и их обработка
Был выполнен предварительный анализ данных, в ходе которого выявлены необходимые шаги по обработке признаков:
- Заполнены пропущенные значения в числовых колонках, таких как `engine`, `mileage`, `max_power`, и `seats`.
- Преобразованы строковые значения в числовые (например, убраны единицы измерения).
- Созданы новые признаки `brand` и `model`, извлеченные из названия машины.
- Закодированы категориальные признаки с использованием обученного кодировщика (`encoder.pkl`). Это улучшило совместимость данных с моделями машинного обучения.

### 2. Подбор моделей и оптимизация гиперпараметров
В ходе работы были протестированы несколько моделей:
- Линейная регрессия (с и без стандартизации признаков)
- Lasso-регрессия и оптимизированная Lasso с подбором гиперпараметра
- ElasticNet-регрессия с использованием GridSearchCV для подбора коэффициентов
- Ridge-регрессия, в которой подбирался коэффициент регуляризации `alpha` с помощью кросс-валидации и GridSearchCV.

#### Основные результаты подбора моделей:
- **Лучшая модель**: Ridge-регрессия с оптимальным значением `alpha=0.1`. Эта модель продемонстрировала наивысшее значение R2 на тестовой выборке (0.925) и минимальную среднеквадратическую ошибку (MSE = 43026155490.66).
- **Наибольший прирост в качестве предсказания**: Подбор параметра `alpha` для Ridge-регрессии дал наибольший прирост качества, позволив модели лучше справляться с шумами и выбросами.

### 3. Оценка с помощью кастомной метрики
В дополнение к стандартным метрикам качества (R2 и MSE) была создана кастомная метрика `business_metric`, которая оценивала процент предсказаний, отличающихся от фактической стоимости не более чем на 10%. Данная метрика позволяет оценить точность модели с позиции бизнеса.

- **Лучший результат по кастомной метрике**: Ridge-регрессия показала наибольшее значение (0.364), что подтверждает выбор Ridge-регрессии как оптимальной модели для задачи предсказания.

### 4. Реализация API на FastAPI
После подбора и обучения модели был создан FastAPI-сервис для предсказания стоимости автомобиля. Сервис предоставляет два эндпоинта:
- **`/predict_item`**: принимает данные одного автомобиля в формате JSON и возвращает предсказанную стоимость.
- **`/predict_items`**: принимает данные о нескольких автомобилях и возвращает файл с предсказаниями стоимости для каждого объекта.

## Выводы и рекомендации

- **Ключевые достижения**: Подбор гиперпараметра `alpha` для Ridge-регрессии дал значительное улучшение качества предсказаний. Благодаря использованию GridSearchCV выбрана модель, которая стабильно показывала высокие результаты по R2 и кастомной метрике.
- **Что можно улучшить**: Сравнение с более сложными моделями (например, случайные леса или градиентный бустинг) не было выполнено в рамках задачи, но может быть полезным для улучшения точности.
- **Ограничения и сложности**: Возникли трудности при реализации FastAPI, а конкретно с обработкой входных данных, так как пришлось полностью заново проходится по всему циклу преобразований каждого признака, на поиск которых уходило не мало времени.

## Заключение
Проделанная работа позволила построить и протестировать несколько моделей, а также внедрить сервис для получения предсказаний.
